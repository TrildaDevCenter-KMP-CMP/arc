"use strict";(self.webpackChunkarc=self.webpackChunkarc||[]).push([[530],{6653:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>u,frontMatter:()=>i,metadata:()=>a,toc:()=>c});var s=t(4848),r=t(8453);const i={title:"Filtering Input/Output"},l=void 0,a={id:"dsl/filters",title:"Filtering Input/Output",description:"The input and output of Agents can be filtered/transformed using the filterInput and filterOutput blocks",source:"@site/docs/01-dsl/filters.md",sourceDirName:"01-dsl",slug:"/dsl/filters",permalink:"/docs/dsl/filters",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{title:"Filtering Input/Output"},sidebar:"tutorialSidebar",previous:{title:"Defining Functions",permalink:"/docs/dsl/defining_functions"},next:{title:"Quickstart",permalink:"/docs/quickstart"}},o={},c=[{value:"Replacing values",id:"replacing-values",level:3},{value:"Removing values",id:"removing-values",level:3},{value:"Custom Filter classes",id:"custom-filter-classes",level:3}];function d(e){const n={code:"code",h3:"h3",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.p,{children:["The input and output of Agents can be filtered/transformed using the ",(0,s.jsx)(n.code,{children:"filterInput"})," and ",(0,s.jsx)(n.code,{children:"filterOutput"})," blocks\nrespectively."]}),"\n",(0,s.jsx)(n.h3,{id:"replacing-values",children:"Replacing values"}),"\n",(0,s.jsxs)(n.p,{children:["Within the filter blocks the keyword ",(0,s.jsx)(n.code,{children:"replaces"})," can be used to replace\noccurrences of values with new values."]}),"\n",(0,s.jsx)(n.p,{children:"Example"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-kts",children:'agent {\n    name = "weather"\n    description = "Agent that provides weather data."\n    systemPrompt = { """ Some system prompt """ }\n    filterInput {\n      "A transformed question" replaces "A question"\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"removing-values",children:"Removing values"}),"\n",(0,s.jsxs)(n.p,{children:["Within the filter blocks the unaryMinus on String and Regex ",(0,s.jsx)(n.code,{children:"-"})," can be used to remove\nvalues."]}),"\n",(0,s.jsx)(n.p,{children:"Example"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-kts",children:'agent {\n    name = "weather"\n    description = "Agent that provides weather data."\n    systemPrompt = { """ Some system prompt """ }\n    filterInput {\n      -"Bad Word"\n      -"Malware.*".toRegex()\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"custom-filter-classes",children:"Custom Filter classes"}),"\n",(0,s.jsxs)(n.p,{children:["Sometimes filter logic can be complex, or you may wish to reuse filters. In these cases, the ",(0,s.jsx)(n.code,{children:"AgentFilter"}),"\ninterface can be used."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-kt",children:"fun interface AgentFilter {\n  /**\n   * Filters or transform Conversation Messages.\n   * If the fun returns null, the message will be removed from the conversation transcript.\n   */\n  suspend fun filter(message: ConversationMessage): ConversationMessage?\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Any ",(0,s.jsx)(n.code,{children:"AgentFilter"})," implementation on the classpath, can be added to the ",(0,s.jsx)(n.code,{children:"filterInput"})," and ",(0,s.jsx)(n.code,{children:"filterOutput"})," blocks using\nthe UnaryPlus ",(0,s.jsx)(n.code,{children:"+"})," operator."]}),"\n",(0,s.jsxs)(n.p,{children:["For example, adding a custom filter class ",(0,s.jsx)(n.code,{children:"MyFilter"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-kts",children:'agent {\n    name = "weather"\n    description = "Agent that provides weather data."\n    systemPrompt = { """ Some system prompt """ }\n    filterInput {\n      +MyFilter::class // context is used to lookup instance of MyFilter\n      +MyFilter() // MyFilter is directly instantiated\n    }\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"Filters can be directly instantiated in the filter blocks, or if the filter class is provided,\nthen a matching bean will be retrieved from the context, for example, the Spring Boot container."})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>l,x:()=>a});var s=t(6540);const r={},i=s.createContext(r);function l(e){const n=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);